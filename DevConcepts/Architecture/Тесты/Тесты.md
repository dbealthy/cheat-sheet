- Сквозные тесты APi должны быть простыми и проверять только работает ли сам вызов к api, все ли базы работают правильно, и не должны проверять бизнес логику. По одному тесту на эндпоинт. Все движущиеся части склеены правильно
- Одна проверка с ошибкой для всех эндпоинтов. Т.к. все ошибки должны обрабатываться одинаково на стороне api
- В идеале вся бизенс логика должна проверятся в сервиснов слое (application). А так же должны проверятся правильные ли ошибки возвращаются
- Точечно тесты могут покрывать и пердметную область
- Выражать сервисный слой с помощью примитивов, а не объектов использовать def add_product(price, article, ...) вмество def add_product(Product(...)), чтобы не те кто используют сервис, не должны были импортировать дитали его реализации (доменные классы). Принцип [[2. Creator]]
- Если создания объектов предметной области избежать не получается, тогда нужно держать это создание в одном месте. Использовать фикстуры
- Когда предметная область сложная нужно писать тесты на нее, как только тесты под нее написаны, становится целесообразнее писать тесты на сервисный слой. Этот процесс похож на переключение передач на велосипеде. Велосипед начинает двигаться на пониженной передаче, чтобы преодалеть инерцию. Затем можно ехать быстрее и эффективнее, переключившись на повышенную передачу. Потом когда перед нами снова появляется крутой холм, мы понижаем передачу.
- **По ходу развития приложения тесты предметной области должны переходть в тесты сервисного слоя.** Поскольку модели предметной области являются приватность ее частью, которая часто может изменяться, то приедтся переписывать кучу тестов, которые зависят от этих моделей. Решение: Переносить тесты из предметного слоя в слой сервисный, который имеет более устойчивый API, чтобы позволит тестам оставаться менее хрупкими

- Тесты уровня сервисов (application) помогут выявить проблемы с дизайном системы, т.к. заставят использовать сервисный уровень в тестах и в дальнейшем помогут сделать качественный рефакторинг. Когда как тесты доменного уровнять позволяют прощупать предметную область и документируют ее. А сквозные тесты позволяют убедиться в работоспособности системы.
- Много тестов в сервисном слое с моками и малость сквозных тестов возволяют очень быстро выполнять тесты
- Разработка через тестирование


![[Pasted image 20250421010400.png]]